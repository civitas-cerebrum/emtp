# Screenshot Processing Module

This module is responsible for extracting text from captured screenshots using Optical Character Recognition (OCR) and cleaning the extracted text for further use.

## Features

- **OCR Text Extraction**: Uses Tesseract OCR to extract text from PNG/TIFF image files.
- **Text Cleaning**: Includes functionalities to clean extracted text, such as removing control characters, fixing "stuck words" (e.g., "HelloWorld" to "Hello World"), and optionally performing grammar and spelling checks using `language_tool_python`.
- **Parallel Processing**: Utilizes multiprocessing to process multiple image files concurrently for improved performance.
- **Input Flexibility**: Can process a single image file or all image files within a specified directory.
- **Output to Text Files**: Saves the processed text into `.txt` files, mirroring the input directory structure.
- **Progress Spinner**: Provides visual feedback during processing for a better user experience.

## Usage

This module can be run as part of the EMTP pipeline or executed standalone.

### As Part of EMTP Pipeline

This module is automatically called by the main EMTP pipeline (`python main.py`) as the third stage. It processes screenshots from `dataset/acquisition/temp/screenshots/` and saves the extracted text to `dataset/acquisition/temp/text_data/`.

### Standalone Usage

```bash
# Process all PNG/TIFF files in an input directory and save to an output directory
python main.py <input_directory> --output <output_directory>

# Process a single image file
python main.py <path_to_image.png> --output <output_directory>

# Use accurate (slower) text cleaning which includes grammar checks
python main.py <input_directory> --output <output_directory> --accurate

# Show help
python main.py --help
```

### Command Line Options

- `input`: Input image file or directory containing PNG/TIFF files (required)
- `-o`, `--output`: Output directory for text files (default: same as input's parent)
- `--accurate`: Use more accurate (slower) processing, enabling language tool checks

## Input

Expects a directory of image files (PNG or TIFF) generated by the `save_screenshot` module.

## Output

Creates `.txt` files in the specified output directory (`dataset/acquisition/temp/text_data/` when run via the pipeline), mirroring the input image file structure.

## Dependencies

- `pytesseract`: Python-Tesseract OCR tool.
- `Pillow`: Python Imaging Library (PIL) fork for image processing.
- `language-tool-python`: For advanced text cleaning and grammar checks (optional, used in accurate mode).
- Tesseract OCR engine: Must be installed on the system (see Tesseract documentation for installation).

## Requirements

- Python 3.7+
- Tesseract OCR engine installed and configured in your system's PATH.
- `pytesseract` and `Pillow` are listed in the main `requirements.txt`.
- `language-tool-python` is listed in the main `requirements.txt`.
